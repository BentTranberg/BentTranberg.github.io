/*! Help & Manual WebHelp 3 Script functions
Copyright (c) 2014-2016 by Tim Green. All rights reserved. Contact tg@it-authoring.com
*/
var scriptEls=document.getElementsByTagName("script"),thisScriptEl=scriptEls[scriptEls.length-1],scriptPath=thisScriptEl.src,hmPopupPath=scriptPath.substr(0,scriptPath.lastIndexOf("/js/")+1);var hmXPopup={};hmXPopup.topicTarget="";hmXPopup.topicExtension="";hmXPopup.visitedTopics={};var doHmXPopup=function(){hmXPopup.PreventDefault=function(q){if(typeof q=="undefined"||q===null){return}if(q.preventDefault){q.preventDefault()}else{q.returnValue=false}};if(jQuery("link#popupstyles").length<1){jQuery("head").append('<link id="popupstyles" rel="stylesheet" type="text/css" href="'+hmPopupPath+'css/hm_popup.css" />')}jQuery.cachedScript=function(r,q){q=jQuery.extend(q||{},{dataType:"script",cache:true,url:r});return jQuery.ajax(q)};var g=navigator.userAgent,d=navigator.platform;hmXPopup.hmBrowser={};hmXPopup.hmBrowser.touch=!!(("ontouchstart" in window)||("msmaxtouchpoints" in window.navigator)||("maxtouchpoints" in window.navigator)||(navigator.maxTouchPoints>0)||(navigator.msMaxTouchPoints>0));hmXPopup.hmBrowser.nonDeskTouch=!!((hmXPopup.hmBrowser.touch&&!/win32/i.test(d))||(hmXPopup.hmBrowser.touch&&/win32/i.test(d)&&/mobile/i.test(g)));hmXPopup.hmBrowser.eventType=(("onmousedown" in window&&!hmXPopup.hmBrowser.nonDeskTouch)?"mouse":("ontouchstart" in window)?"touch":("msmaxtouchpoints" in window.navigator||navigator.msMaxTouchPoints>0)?"mstouchpoints":("maxtouchpoints" in window.navigator||navigator.maxTouchPoints>0)?"touchpoints":"mouse");switch(hmXPopup.hmBrowser.eventType){case"mouse":hmXPopup.hmBrowser.touchstart="mousedown.startevents";hmXPopup.hmBrowser.touchend="mouseup.endevents";hmXPopup.hmBrowser.touchmove="mousemove.moveevents";break;case"touch":hmXPopup.hmBrowser.touchstart="touchstart.startevents";hmXPopup.hmBrowser.touchend="touchend.endevents";hmXPopup.hmBrowser.touchmove="touchmove.moveevents";break;case"mstouchpoints":hmXPopup.hmBrowser.touchstart="MSPointerDown.startevents";hmXPopup.hmBrowser.touchend="MSPointerUp.endevents";hmXPopup.hmBrowser.touchmove="MSPointerMove.moveevents";break;case"touchpoints":hmXPopup.hmBrowser.touchstart="pointerdown.startevents";hmXPopup.hmBrowser.touchend="pointerup.endevents";hmXPopup.hmBrowser.touchmove="pointermove.moveevents";break}hmXPopup.hmDevice={};hmXPopup.hmDevice.agent=navigator.userAgent.toLowerCase();hmXPopup.hmDevice.platform=navigator.platform.toLowerCase();hmXPopup.hmDevice.ipad=/ipad/.test(hmXPopup.hmDevice.platform);hmXPopup.hmDevice.iphone=/iphone/.test(hmXPopup.hmDevice.platform);hmXPopup.hmDevice.winphone7=(/windows phone os [7]\.\d\d??; .*?trident\/[5]\.\d\d??; iemobile\/9/.test(hmXPopup.hmDevice.agent));hmXPopup.hmDevice.winphone=(/windows phone [89]\.\d\d??; .*?trident\/[67]\.\d\d??;.*?touch; /.test(hmXPopup.hmDevice.agent));hmXPopup.hmDevice.w8desktop=(/windows nt 6\.[2345]|windows nt 10\.[0123456]/m.test(hmXPopup.hmDevice.agent));hmXPopup.hmDevice.msBrowser=(/edge|trident/m.test(hmXPopup.hmDevice.agent));hmXPopup.hmDevice.w8metro=(function(){var q=true;try{new ActiveXObject("htmlfile")}catch(r){q=false}return(!q&&hmXPopup.hmDevice.w8desktop&&hmXPopup.hmDevice.msBrowser)})();hmXPopup.hmDevice.touch=!!(("ontouchstart" in window&&!window.opera)||("msmaxtouchppoints" in window.navigator)||("maxtouchppoints" in window.navigator)||(navigator.maxTouchPoints>0)||(navigator.msMaxTouchPoints>0));hmXPopup.hmDevice.tb=(/tablet/.test(hmXPopup.hmDevice.agent)&&(!/trident/.test(hmXPopup.hmDevice.agent)||(hmXPopup.hmDevice.w8metro&&hmXPopup.hmDevice.touch)));hmXPopup.hmDevice.goodandroid=(/android.+?applewebkit\/(?:(?:537\.(?:3[6-9]|[4-9][0-9]))|(?:53[8-9]\.[0-9][0-9])|(?:54[0-9]\.[0-9][0-9]))|android.+?gecko\/[345][0-9]\.\d{1,2} firefox/.test(hmXPopup.hmDevice.agent));hmXPopup.hmDevice.deadandroid=(/android.+?applewebkit\/(?:53[0-6]\.\d{1,2})|firefox\/[0-2]\d\.\d{1,2}/.test(hmXPopup.hmDevice.agent));hmXPopup.hmDevice.android=(/android/.test(hmXPopup.hmDevice.agent)&&!hmXPopup.hmDevice.deadandroid);hmXPopup.hmDevice.mb=/mobi|mobile/.test(hmXPopup.hmDevice.agent);hmXPopup.hmDevice.phone=(hmXPopup.hmDevice.mb&&!hmXPopup.hmDevice.ipad&&!hmXPopup.hmDevice.tb);hmXPopup.hmDevice.tablet=(hmXPopup.hmDevice.ipad||hmXPopup.hmDevice.tb||(!hmXPopup.hmDevice.phone&&hmXPopup.hmDevice.android));hmXPopup.hmDevice.aspectRatio=(screen.height/screen.width>1?screen.height/screen.width:screen.width/screen.height).toFixed(2);hmXPopup.hmDevice.narrowTablet=(hmXPopup.hmDevice.tablet&&hmXPopup.hmDevice.aspectRatio>1.4);hmXPopup.hmDevice.desktop=((!hmXPopup.hmDevice.tablet&&!hmXPopup.hmDevice.phone));hmXPopup.hmDevice.device=hmXPopup.hmDevice.phone?"phone":hmXPopup.tablet?"tablet":hmXPopup.hmDevice.desktop?"desktop":"default";var p=jQuery("body");p.prepend('<div id="hmpopupbox" class="hmpopup"><div id="hmpopuptitlebar" class="hmpopup"><div id="hmpopuptitle"  class="hmpopup"><p class="hmpopup">This is the title bar</p></div><div id="hmclosepopup" class="hmpopup"><span>X</span></div></div><div id="hmpopupbody"><iframe id="hmXPopupFrame" src="" class="hmpopup" frameborder="0"></iframe></div></div>');p.prepend('<div id="dragsurface" style="display: none; position: fixed; top: 0; right: 0; bottom: 0; left: 0; background-image: url(\''+hmPopupPath+"images/spacer.gif')\" />");hmXPopup.$popup=jQuery("div#hmpopupbox");hmXPopup.$popuptitle=jQuery("div#hmpopuptitle > p");hmXPopup.$popupheader=jQuery("div#hmpopuptitlebar");hmXPopup.$popupdragger=jQuery("div#hmpopuptitle");hmXPopup.$dragsurface=jQuery("div#dragsurface");hmXPopup.$popupbody=null;hmXPopup.$popupscroller=null;hmXPopup.$popupwindow=null;hmXPopup.$popframe=jQuery("iframe#hmXPopupFrame");hmXPopup.refPath=hmPopupPath;hmXPopup.currentPopup="";hmXPopup.clickX=0;hmXPopup.clickY=0;hmXPopup.relposX=0;hmXPopup.relposY=0;hmXPopup.hmResizePopup=function(){var s=0,w=0,t=function(){return jQuery(window).width()},A=0,u=0,r=function(){return jQuery(window).height()},y=0,B=0,v=0,q=0,z=function(){return hmXPopup.$popupscroller.height()>hmXPopup.$popupwindow.height()},x=function(){return hmXPopup.$popupscroller.width()>hmXPopup.$popupwindow.width()};s=hmXPopup.$popupbody.outerWidth(true);w=hmXPopup.$popupbody.outerHeight(true);if(x()){hmXPopup.$popup.width((hmXPopup.$popupscroller.width()+10)+"px")}if(z()){v=hmXPopup.$popup.width();q=hmXPopup.$popup.height();do{v+=5;q+=5;hmXPopup.$popup.width(v+"px");hmXPopup.$popup.height(q+"px")}while(z()&&(v<t()*0.5));if(x()){hmXPopup.$popup.width((hmXPopup.$popupscroller.width()+5)+"px")}if(z()){hmXPopup.$popup.height((hmXPopup.$popupheader.height()+hmXPopup.$popupscroller.height()+2)+"px")}}A=t()-5;u=hmXPopup.$popup.outerWidth();y=r()-5;B=hmXPopup.$popup.outerHeight();if((B+hmXPopup.relposY+15<y-5)&&(u+hmXPopup.relposX+30<A-5)){hmXPopup.clickY+=15;hmXPopup.clickX+=30}else{if(B+hmXPopup.relposY+15>y-5){hmXPopup.clickY=jQuery(document).scrollTop()+(y-B);hmXPopup.clickY=hmXPopup.clickY<0?5:hmXPopup.clickY}else{hmXPopup.clickY+=15}if(u+hmXPopup.relposX+30>A-5){if(u+5<hmXPopup.relposX){hmXPopup.clickX=jQuery(document).scrollLeft()+(A-u)}else{hmXPopup.clickX=(jQuery(document).scrollLeft()+A)-(u+5)}hmXPopup.clickX=hmXPopup.clickX<0?5:hmXPopup.clickX}else{hmXPopup.clickX+=30}}hmXPopup.$popup.css({top:(hmXPopup.clickY)+"px",left:(hmXPopup.clickX)+"px"})};hmLoadPopup=function(q){hmXPopup.noresize=false;var s=hmXPopup.$popframe.attr("src");if(s===""||/_hmXtopic.htm$/.test(s)){hmXPopup.$popframe.attr("src",hmXPopup.refPath+"_hmXpopup.htm")}var r=setInterval(function(){hmXPopup.$popupbody=hmXPopup.$popframe.contents().find("div#hmxpopupbody");if(hmXPopup.$popupbody.length>0){clearInterval(r);hmXPopup.$popupscroller=hmXPopup.$popframe.contents().find("body");hmXPopup.$popupwindow=jQuery("div#hmpopupbody");hmXPopup.$popupbody.html(q.hmBody);hmXPopup.$popuptitle.html(q.hmTitle);hmXPopup.$popup.css({height:"3.6rem",width:"20rem"});hmXPopup.$popup.show();hmXPopup.hmResizePopup();if(hmXPopup.hmDevice.desktop&&!hmXPopup.noresize){jQuery("body").on("mousemove.resizepopuplistener",function(u){var t=u.originalEvent;hmXPopup.resizeListener(t)});jQuery("body").on("mousedown.resizepopup",function(t){var u=t.originalEvent;hmXPopup.startResizePopup(u)})}}},30)};var i=function(r){var q="";if(r.hmPrevLink!==""){q=r.hmPrevLink}else{if(r.hmNextLink!==""){q=r.hmNextLink}else{if(r.hmParentLink!==""){q=r.hmParentLink!==""}}}if(q===""){hmXPopup.topicExtension=false}else{hmXPopup.topicExtension=q.substr(q.lastIndexOf("."))}};hmLoadTopic=function(q){hmXPopup.noresize=false;var t="";if(hmXPopup.topicExtension===""){i(q)}if(hmXPopup.topicExtension){hmXPopup.topicTarget=hmPopupPath+hmXPopup.currentPopup.replace(/\.js$/,hmXPopup.topicExtension);t="<p class='linkheader'><a href='"+hmXPopup.topicTarget+"' target='_blank'>Click here to open this topic in a full help window</a></p>"}var s=hmXPopup.$popframe.attr("src");if(s===""||/_hmXpopup.htm$/.test(s)){hmXPopup.$popframe.attr("src",hmXPopup.refPath+"_hmXtopic.htm")}var r=setInterval(function(){hmXPopup.$popupbody=hmXPopup.$popframe.contents().find("div#hmxpopupbody");if(hmXPopup.$popupbody.length>0){clearInterval(r);hmXPopup.$popupscroller=hmXPopup.$popframe.contents().find("body");hmXPopup.$popupwindow=jQuery("div#hmpopupbody");hmXPopup.$popupbody.html(t+q.hmBody);hmXPopup.$popuptitle.html(q.hmTitle);hmXPopup.$popup.css({height:"3.6rem",width:"20rem"});hmXPopup.$popup.show();hmXPopup.hmResizePopup();if(hmXPopup.hmDevice.desktop&&!hmXPopup.noresize){jQuery("body").on("mousemove.resizepopuplistener",function(v){var u=v.originalEvent;hmXPopup.resizeListener(u)});jQuery("body").on("mousedown.resizepopup",function(u){var v=u.originalEvent;hmXPopup.startResizePopup(v)})}hmXPopup.$popupbody.find("img.image-toggle").parent("a").on("click",function(u){u.preventDefault();document.getElementById("hmXPopupFrame").contentWindow.hmWebHelp.extFuncs("hmImageToggle",(jQuery(this).children("img").first()))})}},30)};hmXPopup.closePopup=function(){if(hmXPopup.$popup.is(":hidden")){return}hmXPopup.$popup.fadeOut(300);if(hmXPopup.hmDevice.desktop){jQuery("body").off(".resizepopup").off(".resizepopuplistener");hmXPopup.$dragsurface.off(".resizepopup")}hmXPopup.$popupbody.find("iframe").attr("src","");var q=hmXPopup.$popupbody.find("object,embed,param");if(q.length>0){if(/trident|edge/i.test(window.navigator.userAgent)){document.location.reload()}else{q.attr("data","").attr("src","").attr("value","").remove()}}hmXPopup.$popupscroller.find("div#imagetogglebox").remove();hmXPopup.$popup.attr("style","");hmXPopup.$popupbody.html("");l()};var f=function(q){if(/\.js$/i.test(q)){return q.toLowerCase()}else{return q.toLowerCase()+".js"}};hmXPopup.loadPopup=function(u,t,q){var s=t,r="";if(Object.keys(hmXPopup.visitedTopics).length>300){hmXPopup.visitedTopics={}}hmXPopup.clickX=u.pageX;hmXPopup.relposX=hmXPopup.clickX-jQuery(document).scrollLeft();hmXPopup.clickY=u.pageY;hmXPopup.relposY=hmXPopup.clickY-jQuery(document).scrollTop();if(typeof q=="undefined"){q=hmPopupPath+"jspopups/"}hmXPopup.currentPopup=t;r=q+t;if(hmXPopup.visitedTopics.hasOwnProperty(s)){$.cachedScript(r).done(function(v,w){})}else{jQuery.getScript(r,function(v,x,w){hmXPopup.visitedTopics[s]=true})}};jQuery("a.hmpopuplink").on("click",function(q){q.preventDefault();hmXPopup.loadPopup(q,f(jQuery(this).attr("data-target")),hmPopupPath+"jspopups/")});jQuery("a.hmtopiclink").on("click",function(q){q.preventDefault();hmXPopup.loadPopup(q,f(jQuery(this).attr("data-target")),hmPopupPath+"jstopics/")});jQuery("div#hmclosepopup").on(hmXPopup.hmBrowser.touchstart,hmXPopup.closePopup);jQuery(document).keyup(function(q){if(q.keyCode==27){hmXPopup.closePopup()}});var c=0,e=0,k=0,o,n,b,j;var a=function(q){if(q.pointerType=="mouse"||q.pointerType==4){return"mouse"}else{if(q.pointerType=="touch"||q.pointerType==2||q.pointerType=="pen"||q.pointerType==3){return"touch"}else{if(/^mouse/i.test(q.type)){return"mouse"}else{if(/^touch/i.test(q.type)||/^pen/i.test(q.type)){return"touch"}else{return"none"}}}}};var l=function(q){e=new Date().getTime()-c;if(e<200){}hmXPopup.$popupdragger.off(".endevents");hmXPopup.$popupdragger.off(".moveevents");hmXPopup.$dragsurface.off(".endevents");hmXPopup.$dragsurface.off(".moveevents");hmXPopup.$dragsurface.hide().css("cursor","default");hmXPopup.PreventDefault(q)};var m=function(t){e=new Date().getTime()-c;if(e<50){return}var r;if(typeof t.changedTouches!="undefined"){r=t.changedTouches[0]}else{r=t}k++;if(hmXPopup.hmDevice.desktop||k>2){k=0;var s=(!(document.all&&!window.opera))?r.pageX-o:r.clientX-o;var q=(!(document.all&&!window.opera))?r.pageY-n:r.clientY-n;hmXPopup.$popup.css({left:(b+s)+"px"});hmXPopup.$popup.css({top:(j+q)+"px"})}};var h=function(r){hmXPopup.PreventDefault(r);c=new Date().getTime();var q;if(typeof r.changedTouches!="undefined"){q=r.changedTouches[0]}else{q=r}o=(!(document.all&&!window.opera))?q.pageX:q.clientX;n=(!(document.all&&!window.opera))?q.pageY:q.clientY;b=hmXPopup.$popup.position().left;j=hmXPopup.$popup.position().top;if(hmXPopup.hmBrowser.touch||hmXPopup.hmDevice.winphone||a(r)=="mouse"){hmXPopup.$dragsurface.css("cursor","all-scroll").show();hmXPopup.$dragsurface.on(hmXPopup.hmBrowser.touchmove,function(t){var s=t.originalEvent;m(s)});hmXPopup.$dragsurface.on(hmXPopup.hmBrowser.touchend,function(t){var s=t.originalEvent;l(s)})}hmXPopup.$popupdragger.on(hmXPopup.hmBrowser.touchmove,function(t){var s=t.originalEvent;m(s)});hmXPopup.$popupdragger.on(hmXPopup.hmBrowser.touchend,function(t){var s=t.originalEvent;l(s)})};hmXPopup.$popupdragger.on(hmXPopup.hmBrowser.touchstart,function(r){var q=r.originalEvent;h(q)});if(hmXPopup.hmDevice.desktop){hmXPopup.resizeListener=function(x){var v=hmXPopup.$popup.position(),w=hmXPopup.$popup.outerWidth(),u=hmXPopup.$popup.outerHeight(),r=2;hmXPopup.ewResize="ew-resize";hmXPopup.nsResize="ns-resize";var s=((x.pageX>(v.left+(w-4)))&&(x.pageX<(v.left+w+8))&&(x.pageY>v.top)&&(x.pageY<v.top+u+8));var q=((x.pageY>(v.top+(u-8-r)))&&(x.pageY<(v.top+u+10))&&(x.pageX<(v.left+w+10))&&(x.pageX>v.left+4));var t=((s&&(x.pageY>(v.top+u-10)))||(q&&x.pageX>(v.left+w-10)));hmXPopup.bdDrag=s||q;jQuery("body").css("cursor",function(){return t?"nw-resize":s&&!q?hmXPopup.ewResize:q&&!s?hmXPopup.nsResize:"auto"})};hmXPopup.deSelect=function(){if(window.getSelection){window.getSelection().removeAllRanges()}else{if(document.selection){document.selection.empty()}}return false};hmXPopup.doResizePopup=function(s,u){hmXPopup.deSelect();var r=s.pageX-hmXPopup.resizeX,q=s.pageY-hmXPopup.resizeY,v=hmXPopup.popdims.w+r,t=hmXPopup.popdims.h+q;switch(u){case"horizontal":t=hmXPopup.popdims.h;break;case"vertical":v=hmXPopup.popdims.w;break}if(t<50){t=50}if(v<200){v=200}hmXPopup.$popup.css({width:v+"px","max-width":v+"px",height:t+"px","max-height":t+"px"})};hmXPopup.endResizePopup=function(q){hmXPopup.$dragsurface.off("mousemove.resizepopup");jQuery("body").off("mouseup.resizepopup");hmXPopup.$popupbody.css("overflow","auto");jQuery("body").css("cursor","default");hmXPopup.$dragsurface.css("cursor","default").hide()};hmXPopup.startResizePopup=function(s){var r=jQuery("body").css("cursor");function q(t){hmXPopup.resizeX=s.pageX;hmXPopup.resizeY=s.pageY;hmXPopup.$popupbody.css("overflow","hidden");hmXPopup.popdims={};hmXPopup.popdims.w=hmXPopup.$popup.width();hmXPopup.popdims.h=hmXPopup.$popup.height();jQuery("body").on("mouseup.resizepopup",function(u){var v=u.orginalEvent;hmXPopup.endResizePopup(v)});hmXPopup.$dragsurface.css("cursor",r);jQuery("body").css("cursor",r);hmXPopup.$dragsurface.show().on("mousemove.resizepopup",function(u){var v=u.originalEvent;hmXPopup.doResizePopup(v,t)})}switch(r){case"ew-resize":q("horizontal");break;case"nw-resize":q("diagonal");break;case"ns-resize":q("vertical");break}}}};if(typeof jQuery==="undefined"){var jQ=document.createElement("script");jQ.setAttribute("type","text/javascript");jQ.setAttribute("src",hmPopupPath+"js/jquery.js");document.getElementsByTagName("head")[0].appendChild(jQ);var jQLoader=setInterval(function(){if(typeof jQuery==="function"){clearInterval(jQLoader);jQuery(document).ready(function(){doHmXPopup()})}},50)}else{jQuery(document).ready(function(){doHmXPopup()})};
