/*! Help & Manual WebHelp 3 Script functions
Copyright (c) 2014-2016 by Tim Green. All rights reserved. Contact tg@it-authoring.com
*/
var hmXPopup={};var $popparent=$("body");$popparent.append('<div id="hmpopupbox" class="hmpopup"><div id="hmpopuptitlebar" class="hmpopup"><div id="hmpopuptitle" class="hmpopup"><p class="hmpopup">This is the title bar</p></div><div id="hmclosepopup" class="hmpopup"><span>X</span></div></div><div id="hmpopupbody"></div></div>');hmXPopup.$popup=$("div#hmpopupbox");hmXPopup.$popupcontainer=$("div#topicbox");hmXPopup.$popuptitle=$("div#hmpopuptitle > p");hmXPopup.$popupheader=$("div#hmpopuptitlebar");hmXPopup.$popupdragger=$("div#hmpopuptitle");hmXPopup.$popupbody=$("div#hmpopupbody");hmXPopup.popupwindow=hmXPopup.$popupbody[0];hmXPopup.$dragsurface=$("div#dragsurface");hmXPopup.refPath="./jspopups/";hmXPopup.clickX=0;hmXPopup.clickY=0;hmXPopup.posX=0;hmXPopup.posY=0;hmXPopup.PreventDefault=function(a){if(typeof a=="undefined"||a===null){return}if(a.preventDefault){a.preventDefault()}else{a.returnValue=false}};hmXPopup.sizeAndPosition=function(){hmXPopup.posX=hmXPopup.clickX;hmXPopup.posY=hmXPopup.clickY;var k=function(q,r){if(typeof q==="string"&&q.charAt(q.length-1)==="%"){return parseFloat(q,10)}else{r=typeof r==="string"?parseFloat(r,10):r;q=typeof q==="string"?parseFloat(q,10):q;return((q/r)*100)}};var c=function(){return $(window).width()},o=0,e=0,b=function(){return $(window).height()},i=0,p=0,l=function(){return hmXPopup.popupwindow.clientHeight<hmXPopup.popupwindow.scrollHeight},h=function(){return hmXPopup.popupwindow.clientWidth<hmXPopup.popupwindow.scrollWidth},g=0,a=0,j=false,f=k(hmXPopup.$popup.css("max-width"),c())/100,d=k(hmXPopup.$popup.css("max-height"),b())/100,n=hmDevice.desktop?hmXPopup.$popupcontainer:$(window);var m=function(){var r=c(),q=hmXPopup.$popup.width(),t=b(),s=hmXPopup.$popup.height();hmXPopup.$popup.css({width:k(q,r)+"%",height:k(s,t)+"%"})};if(h()){hmXPopup.$popup.width((hmXPopup.popupwindow.scrollWidth+5)+"px");j=true}if(l()){g=hmXPopup.$popup.width();a=hmXPopup.$popup.height();j=true;do{g+=5;a+=5;hmXPopup.$popup.width(g+"px");hmXPopup.$popup.height(a+"px")}while(l()&&(g<n.width()*f));if(h()){hmXPopup.$popup.width((hmXPopup.popupwindow.scrollWidth+5)+"px")}if(l()){hmXPopup.$popup.height((hmXPopup.$popupheader.height()+hmXPopup.popupwindow.scrollHeight+2)+"px")}}o=c()-5;e=hmXPopup.$popup.width();i=b()-5;p=hmXPopup.$popup.height();if((p+hmXPopup.posY+15<i-5)&&(e+hmXPopup.posX+30<o-5)){hmXPopup.posY+=15;hmXPopup.posX+=30}else{if(p+hmXPopup.posY+15>i-5){hmXPopup.posY=i-(p+5);hmXPopup.posY=hmXPopup.posY<0?5:hmXPopup.posY}else{hmXPopup.posY+=15}if(e+hmXPopup.posX+30>o-5){if(e+5<hmXPopup.posX){hmXPopup.posX=hmXPopup.posX-(e+5)}else{hmXPopup.posX=o-(e+5)}hmXPopup.posX=hmXPopup.posX<0?5:hmXPopup.posX}else{hmXPopup.posX+=30}}if(hmDevice.ipad){hmXPopup.posX-=20;hmXPopup.posY-=20}hmXPopup.$popup.css({top:(hmXPopup.posY)+"px",left:(hmXPopup.posX)+"px"});if(j&&(hmXPopup.$popup.width()>hmXPopup.$popupcontainer.width()*0.5||hmXPopup.$popup.height()>hmXPopup.$popupcontainer.height()*0.5)){m()}};hmXPopup.closePopup=function(){hmXPopup.$popup.fadeOut(300);if(hmDevice.desktop){$("body").off(".resizepopup").off(".resizepopuplistener");hmXPopup.$dragsurface.off(".resizepopup").attr("style","");$("input#bookmarkPermalink").off("mousedown")}if(hmXPopup.social&&$("script#gplus_script").length>0){$("script#gplus_script").remove()}if(!hmXPopup.social&&!hmXPopup.permalink){hmXPopup.$popupbody.find("iframe").attr("src","");var a=hmXPopup.$popupbody.find("object,embed,param");if(a.length>0){if(/trident|edge/i.test(window.navigator.userAgent)){document.location.reload()}else{a.attr("data","").attr("src","").attr("value","").remove()}}}hmXPopup.$popup.attr("style","");hmXPopup.$popupbody.html("")};hmXPopup.bookmarkPermalink=function(){if(hmBrowser.server){alert("Right-click on permalink to copy, then press CTRL+D or CMD+D to bookmark.")}else{alert("This page is stored locally. You can only bookmark pages on a web server.")}};hmLoadPopup=function(b){hmXPopup.$popupbody.html(b.hmBody);hmXPopup.$popuptitle.html(b.hmTitle);if(typeof b.dims==="undefined"){hmXPopup.$popup.css({height:"3.6rem",width:"20rem"})}else{hmXPopup.$popup.css(b.dims)}hmXPopup.noresize=false;if(typeof b.permalink!=="undefined"&&b.permalink){hmXPopup.noresize=true;$("textarea#plinkBox").text(document.location.protocol+"//"+document.location.hostname+document.location.pathname);$("p#permalink_tip").text("Right-click on permalink to copy to clipboard");$("input#bookmarkPermalink").attr("value","Bookmark Topic");$("input#selectPermalink").on(hmBrowser.touchstart,function(){$("textarea#plinkBox").focus().select()});$("textarea#plinkBox").on("mousedown",function(d){if(d.button==2){$(this).focus().select()}});$("input#bookmarkPermalink").on("mousedown",function(){hmXPopup.bookmarkPermalink()})}hmXPopup.$popup.show();hmXPopup.sizeAndPosition();if(typeof hmXPopup.social!=="undefined"&&hmXPopup.social){setTimeout(hmXPopup.sizeAndPosition,3000)}if(typeof b.permalink!=="undefined"&&b.permalink){var a=(hmXPopup.$popup.height()+7)+"px",c=($("textarea#plinkBox").width()+25)+"px";hmXPopup.$popup.css({width:c,"min-width":c,height:a,"min-height":a});$("textarea#plinkBox").focus().select()}if(hmDevice.desktop&&!hmXPopup.noresize){$("body").off("mousemove.resizepopuplistener").on("mousemove.resizepopuplistener",function(e){var d=e.originalEvent;hmXPopup.resizeListener(d)});$("body").off("mousedown.resizepopup").on("mousedown.resizepopup",function(d){var f=d.originalEvent;hmXPopup.startResizePopup(f)})}};hmXPopup.loadPopup=function(f,d,b){var a=false,h=f.substr(f.lastIndexOf(".")+1,2),g="",e=hmXPopup.refPath;if(typeof d!=="undefined"){e=d;if(h!=="js"){a=true}}if(Object.keys(hmWebHelp.visitedTopics).length>300){hmWebHelp.visitedTopics={}}if(e.charAt(e.length-1)!=="/"){e+="/"}g=e+f;if(!a){hmXPopup.social=!!(f==="socialsharing.js");if(!hmWebHelp.visitedTopics.hasOwnProperty(f)){$.getScript(g,function(i,k,j){if(k!=="success"){alert("Error loading popup file: "+g)}else{hmWebHelp.visitedTopics[f]=true}})}else{$.cachedScript(g).done(function(i,j){if(j!=="success"){alert("Error loading popup file: "+g)}})}}else{var c={};c.hmTitle=typeof b==="string"?b:"";c.permalink=!!(f==="_hmpermalink.html");$.get(g,function(i){c.hmBody=i;hmLoadPopup(c)},"html")}};hmXPopup.$popupbody.on("click","a.topiclink, a.topichotspot",function(a){a.preventDefault();a.stopPropagation()}).on(hmBrowser.touchstart,"a.topiclink, a.topichotspot",function(d){d.preventDefault();d.stopPropagation();var e=$(this).attr("href");if(!e){return}var a=e.indexOf("#")>1?e.split("#").pop():false,c=document.location.pathname.split("/").pop(),f=e.indexOf("#")>1?e.substr(0,e.lastIndexOf("#")):e,b=c!==f;if(a&&!b){hmWebHelp.scrollTopic(a)}else{e=hmWebHelp.targetCheck($(this).attr("href"));if(hmWebHelp.hmMainPageCheck(e)){History.pushState(null,null,e)}}});hmXPopup.$popupbody.on(hmBrowser.touchstart,"a.weblink, a.webhotspot",function(a){$(this).attr("target","_blank")});hmXPopup.$popupbody.on(hmBrowser.touchstart,"a.popuplink,a.popuphotspot,a.topichotspot[href^='javascript:void']",function(b){b.preventDefault();hmXPopup.clickX=hmXPopup.$popup.position().left;hmXPopup.clickY=hmXPopup.$popup.position().top;var a=$(this).attr("data-target");hmXPopup.loadPopup(a)});$("div#hmclosepopup").on(hmBrowser.touchstart,hmXPopup.closePopup);hmXPopup.EventType=function(a){if(a.pointerType=="mouse"||a.pointerType==4){return"mouse"}else{if(a.pointerType=="touch"||a.pointerType==2||a.pointerType=="pen"||a.pointerType==3){return"touch"}else{if(/^mouse/i.test(a.type)){return"mouse"}else{if(/^touch/i.test(a.type)||/^pen/i.test(a.type)){return"touch"}else{return"none"}}}}};hmXPopup.startTime=0;hmXPopup.dragTime=0;hmXPopup.dragcount=0;hmXPopup.oldX=undefined;hmXPopup.oldY=undefined;hmXPopup.oldLeftPos=undefined;hmXPopup.oldTopPos=undefined;hmXPopup.endDrag=function(a){hmXPopup.dragTime=new Date().getTime()-hmXPopup.startTime;if(hmXPopup.dragTime<200){}hmXPopup.$popupdragger.off(".endevents");hmXPopup.$popupdragger.off(".moveevents");hmXPopup.$dragsurface.off(".endevents");hmXPopup.$dragsurface.off(".moveevents");hmXPopup.$dragsurface.hide().css("cursor","col-resize");hmXPopup.PreventDefault(a)};hmXPopup.performDrag=function(d){hmXPopup.dragTime=new Date().getTime()-hmXPopup.startTime;if(hmXPopup.dragTime<50){return}var b;if(typeof d.changedTouches!="undefined"){b=d.changedTouches[0]}else{b=d}hmXPopup.dragcount++;if(hmDevice.desktop||hmXPopup.dragcount>2){hmXPopup.dragcount=0;var c=(!(document.all&&!window.opera))?b.pageX-hmXPopup.oldX:b.clientX-hmXPopup.oldX;var a=(!(document.all&&!window.opera))?b.pageY-hmXPopup.oldY:b.clientY-hmXPopup.oldY;hmXPopup.$popup.css({left:(hmXPopup.oldLeftPos+c)+"px"});hmXPopup.$popup.css({top:(hmXPopup.oldTopPos+a)+"px"})}};hmXPopup.startDrag=function(b){hmXPopup.PreventDefault(b);hmXPopup.startTime=new Date().getTime();var a;if(typeof b.changedTouches!="undefined"){a=b.changedTouches[0]}else{a=b}hmXPopup.oldX=(!(document.all&&!window.opera))?a.pageX:a.clientX;hmXPopup.oldY=(!(document.all&&!window.opera))?a.pageY:a.clientY;hmXPopup.oldLeftPos=hmXPopup.$popup.position().left;hmXPopup.oldTopPos=hmXPopup.$popup.position().top;if(hmBrowser.touch||hmDevice.winphone||hmXPopup.EventType(b)=="mouse"){hmXPopup.$dragsurface.css("cursor","all-scroll").show();hmXPopup.$dragsurface.on(hmBrowser.touchmove,function(d){var c=d.originalEvent;hmXPopup.performDrag(c)});hmXPopup.$dragsurface.on(hmBrowser.touchend,function(d){var c=d.originalEvent;hmXPopup.endDrag(c)})}hmXPopup.$popupdragger.on(hmBrowser.touchmove,function(d){var c=d.originalEvent;hmXPopup.performDrag(c)});hmXPopup.$popupdragger.on(hmBrowser.touchend,function(d){var c=d.originalEvent;hmXPopup.endDrag(c)})};hmXPopup.$popupdragger.off(hmBrowser.touchstart).on(hmBrowser.touchstart,function(b){var a=b.originalEvent;hmXPopup.startDrag(a)});if(hmDevice.desktop){hmXPopup.resizeListener=function(i){var g=hmXPopup.$popup.position(),h=hmXPopup.$popup.outerWidth(),f=hmXPopup.$popup.outerHeight(),b=2;hmXPopup.ewResize="ew-resize";hmXPopup.nsResize="ns-resize";var c=((i.pageX>(g.left+(h-4)))&&(i.pageX<(g.left+h+8))&&(i.pageY>g.top)&&(i.pageY<g.top+f+8));var a=((i.pageY>(g.top+(f-4-b)))&&(i.pageY<(g.top+f+8))&&(i.pageX<(g.left+h+8))&&(i.pageX>g.left+4));var d=((c&&(i.pageY>(g.top+f-10)))||(a&&i.pageX>(g.left+h-10)));hmXPopup.bdDrag=c||a;$("body").css("cursor",function(){return d?"nw-resize":c&&!a?hmXPopup.ewResize:a&&!c?hmXPopup.nsResize:"auto"})};hmXPopup.deSelect=function(){if(window.getSelection){window.getSelection().removeAllRanges()}else{if(document.selection){document.selection.empty()}}return false};hmXPopup.doResizePopup=function(c,e){hmXPopup.deSelect();var b=c.clientX-hmXPopup.resizeX,a=c.clientY-hmXPopup.resizeY,f=hmXPopup.popdims.w+b,d=hmXPopup.popdims.h+a;switch(e){case"horizontal":d=hmXPopup.popdims.h;break;case"vertical":f=hmXPopup.popdims.w;break}hmXPopup.$popup.css({width:f+"px","max-width":f+"px",height:d+"px","max-height":d+"px"})};hmXPopup.endResizePopup=function(a){hmXPopup.$dragsurface.off("mousemove.resizepopup");$("body").off("mouseup.resizepopup");hmXPopup.$popupbody.css("overflow","auto");$("body").css("cursor","default");hmXPopup.$dragsurface.css("cursor","default").hide()};hmXPopup.startResizePopup=function(c){var b=$("body").css("cursor");function a(d){hmXPopup.resizeX=c.pageX;hmXPopup.resizeY=c.pageY;hmXPopup.$popupbody.css("overflow","hidden");hmXPopup.popdims={};hmXPopup.popdims.w=hmXPopup.$popup.width();hmXPopup.popdims.h=hmXPopup.$popup.height();$("body").on("mouseup.resizepopup",function(f){var g=f.orginalEvent;hmXPopup.endResizePopup(g)});hmXPopup.$dragsurface.css("cursor",b);$("body").css("cursor",b);hmXPopup.$dragsurface.show().on("mousemove.resizepopup",function(f){var g=f.originalEvent;hmXPopup.doResizePopup(g,d)})}switch(b){case"ew-resize":a("horizontal");break;case"nw-resize":a("diagonal");break;case"ns-resize":a("vertical");break}}};
